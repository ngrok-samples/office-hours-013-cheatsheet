on_http_request:
  - actions:
      - type: rate-limit
        config:
          name: Only allow 5 requests per minute
          algorithm: sliding_window
          capacity: 5
          rate: 60s
          bucket_key:
            - "hasReqHeader('host') ? getReqHeader('host')[0] : 'unknown'"